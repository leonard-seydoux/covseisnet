
.. DO NOT EDIT.
.. THIS FILE WAS AUTOMATICALLY GENERATED BY SPHINX-GALLERY.
.. TO MAKE CHANGES, EDIT THE SOURCE PYTHON FILE:
.. "auto_examples/plot_example_3.py"
.. LINE NUMBERS ARE GIVEN BELOW.

.. only:: html

    .. note::
        :class: sphx-glr-download-link-note

        :ref:`Go to the end <sphx_glr_download_auto_examples_plot_example_3.py>`
        to download the full example code.

.. rst-class:: sphx-glr-example-title

.. _sphx_glr_auto_examples_plot_example_3.py:


Stream whitening
================

This example show the effect of spectral whitening on a stream of traces.
The stream is read from the obspy example data, and the whitening is performed
with the method :func:`~covseisnet.stream.NetworkStream.whiten`. The method
applies a Fourier transform to the traces, divides the spectrum of the traces
by the modulus of the spectrum (or a smooth version of it), and then applies the
inverse Fourier transform to the traces.

.. GENERATED FROM PYTHON SOURCE LINES 12-17

.. code-block:: Python


    import matplotlib.pyplot as plt

    import covseisnet as csn








.. GENERATED FROM PYTHON SOURCE LINES 18-23

Read the example stream (shipped with ObsPy)
--------------------------------------------

The stream is read from the obspy example data, and is available without any
argument. The stream is then plotted to visualize the traces.

.. GENERATED FROM PYTHON SOURCE LINES 23-29

.. code-block:: Python


    stream = csn.read()

    # Plot trace and corresponding spectrum
    csn.plotting.plot_trace_and_spectrum(stream[0])




.. image-sg:: /auto_examples/images/sphx_glr_plot_example_3_001.png
   :alt: plot example 3
   :srcset: /auto_examples/images/sphx_glr_plot_example_3_001.png, /auto_examples/images/sphx_glr_plot_example_3_001_4_00x.png 4.00x
   :class: sphx-glr-single-img





.. GENERATED FROM PYTHON SOURCE LINES 30-38

Spectral whitening on a small window
------------------------------------

The spectral whitening is applied to the stream using the method
:func:`~covseisnet.stream.NetworkStream.whiten`. The method applies a Fourier
transform to the traces, divides the spectrum of the traces by the modulus of
the spectrum (or a smooth version of it), and then applies the inverse Fourier
transform to the traces. The whit

.. GENERATED FROM PYTHON SOURCE LINES 38-45

.. code-block:: Python


    whitened_stream = stream.copy()
    whitened_stream.whiten(window_duration_sec=2)

    # Plot whitened trace and corresponding spectrum
    csn.plotting.plot_trace_and_spectrum(whitened_stream[0])




.. image-sg:: /auto_examples/images/sphx_glr_plot_example_3_002.png
   :alt: plot example 3
   :srcset: /auto_examples/images/sphx_glr_plot_example_3_002.png, /auto_examples/images/sphx_glr_plot_example_3_002_4_00x.png 4.00x
   :class: sphx-glr-single-img





.. GENERATED FROM PYTHON SOURCE LINES 46-54

Spectral whitening on the entire signal
---------------------------------------

The spectral whitening is applied to the stream using the method
:func:`~covseisnet.stream.NetworkStream.whiten`. The method applies a Fourier
transform to the traces, divides the spectrum of the traces by the modulus of
the spectrum (or a smooth version of it), and then applies the inverse Fourier
transform to the traces. The whit

.. GENERATED FROM PYTHON SOURCE LINES 54-60

.. code-block:: Python


    whitened_stream = stream.copy()
    whitened_stream.whiten(window_duration_sec=20)

    # Plot whitened trace and corresponding spectrum
    csn.plotting.plot_trace_and_spectrum(whitened_stream[0])



.. image-sg:: /auto_examples/images/sphx_glr_plot_example_3_003.png
   :alt: plot example 3
   :srcset: /auto_examples/images/sphx_glr_plot_example_3_003.png, /auto_examples/images/sphx_glr_plot_example_3_003_4_00x.png 4.00x
   :class: sphx-glr-single-img






.. rst-class:: sphx-glr-timing

   **Total running time of the script:** (0 minutes 1.511 seconds)


.. _sphx_glr_download_auto_examples_plot_example_3.py:

.. only:: html

  .. container:: sphx-glr-footer sphx-glr-footer-example

    .. container:: sphx-glr-download sphx-glr-download-jupyter

      :download:`Download Jupyter notebook: plot_example_3.ipynb <plot_example_3.ipynb>`

    .. container:: sphx-glr-download sphx-glr-download-python

      :download:`Download Python source code: plot_example_3.py <plot_example_3.py>`


.. only:: html

 .. rst-class:: sphx-glr-signature

    `Gallery generated by Sphinx-Gallery <https://sphinx-gallery.github.io>`_
