
<!DOCTYPE html>


<html lang="english" data-content_root="../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Locating events within a constant velocity model &#8212; covseisnet</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="../_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=a746c00c" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/sphinx-book-theme.css?v=a3416100" />
    <link rel="stylesheet" type="text/css" href="../_static/plot_directive.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sg_gallery.css?v=d2d258e8" />
    <link rel="stylesheet" type="text/css" href="../_static/sg_gallery-binder.css?v=f4aeca0c" />
    <link rel="stylesheet" type="text/css" href="../_static/sg_gallery-dataframe.css?v=2082cf3c" />
    <link rel="stylesheet" type="text/css" href="../_static/sg_gallery-rendered-html.css?v=1277b6f3" />
    <link rel="stylesheet" type="text/css" href="../_static/custom.css?v=17ebe808" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="../_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script src="../_static/documentation_options.js?v=e872a992"></script>
    <script src="../_static/doctools.js?v=9a2dae69"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'auto_examples/plot_example_d3_constant_velocity_loc';</script>
    <link rel="icon" href="../_static/logo_covseisnet_small.svg"/>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="API Reference" href="../api.html" />
    <link rel="prev" title="Constant velocity differential times" href="plot_example_d2_constant_velocity_diff.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="english"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search..."
         aria-label="Search..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="../index.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../_static/logo_covseisnet_normal.svg" class="logo__image only-light" alt="Covseisnet logo"/>
    <script>document.write(`<img src="../_static/logo_covseisnet_normal.svg" class="logo__image only-dark" alt="Covseisnet logo"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../index.html">
                    Home
                </a>
            </li>
        </ul>
        <ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../installation.html">Installation Guide</a></li>
<li class="toctree-l1 current active has-children"><a class="reference internal" href="index.html">Gallery</a><details open="open"><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="plot_example_a1_sync.html">Traces synchronization</a></li>
<li class="toctree-l2"><a class="reference internal" href="plot_example_a2_norm.html">Temporal normalization</a></li>
<li class="toctree-l2"><a class="reference internal" href="plot_example_a3_whiten.html">Spectral whitening</a></li>
<li class="toctree-l2"><a class="reference internal" href="plot_example_b1_coherence.html">Spectral width</a></li>
<li class="toctree-l2"><a class="reference internal" href="plot_example_b2_coherence_preprocess.html">Compare pre-processing</a></li>
<li class="toctree-l2"><a class="reference internal" href="plot_example_c1_correlations.html">Cross-correlation at USArray</a></li>
<li class="toctree-l2"><a class="reference internal" href="plot_example_d1_constant_velocity.html">Constant velocity travel times</a></li>
<li class="toctree-l2"><a class="reference internal" href="plot_example_d2_constant_velocity_diff.html">Constant velocity differential times</a></li>
<li class="toctree-l2 current active"><a class="current reference internal" href="#">Locating events within a constant velocity model</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../api.html">API Reference</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../stream.html">Network stream</a></li>
<li class="toctree-l2"><a class="reference internal" href="../signal.html">Signal processing</a></li>
<li class="toctree-l2"><a class="reference internal" href="../covariance.html">Covariance Matrix</a></li>
<li class="toctree-l2"><a class="reference internal" href="../correlation.html">Cross-correlation matrix</a></li>
<li class="toctree-l2"><a class="reference internal" href="../plot.html">Plotting tools</a></li>
<li class="toctree-l2"><a class="reference internal" href="../data.html">Data management</a></li>
<li class="toctree-l2"><a class="reference internal" href="../spatial.html">Geographical and spatial functions</a></li>
<li class="toctree-l2"><a class="reference internal" href="../velocity.html">Velocity models</a></li>
<li class="toctree-l2"><a class="reference internal" href="../travel_times.html">Travel times</a></li>
<li class="toctree-l2"><a class="reference internal" href="../backprojection.html">Backprojection</a></li>
</ul>
</details></li>
<li class="toctree-l1"><a class="reference internal" href="../license.html">License</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/leonard-seydoux/covseisnet" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/leonard-seydoux/covseisnet/issues/new?title=Issue%20on%20page%20%2Fauto_examples/plot_example_d3_constant_velocity_loc.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm pst-navbar-icon search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Locating events within a constant velocity model</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#load-seismograms">Load seismograms</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#station-and-source-coordinates">Station and source coordinates</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#evaluate-covariance-matrix">Evaluate covariance matrix</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#evaluate-the-pairwise-cross-correlation-functions">Evaluate the pairwise cross-correlation functions</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#calculate-travel-times">Calculate travel times</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#locate-the-source-with-backprojection">Locate the source with backprojection</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#compare-maximum-likelihood-with-known-source-location">Compare maximum likelihood with known source location</a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <div class="sphx-glr-download-link-note admonition note">
<p class="admonition-title">Note</p>
<p><a class="reference internal" href="#sphx-glr-download-auto-examples-plot-example-d3-constant-velocity-loc-py"><span class="std std-ref">Go to the end</span></a>
to download the full example code.</p>
</div>
<section class="sphx-glr-example-title" id="locating-events-within-a-constant-velocity-model">
<span id="sphx-glr-auto-examples-plot-example-d3-constant-velocity-loc-py"></span><h1>Locating events within a constant velocity model<a class="headerlink" href="#locating-events-within-a-constant-velocity-model" title="Link to this heading">#</a></h1>
<p>This example shows how to calculate the differential travel times of seismic
waves in a constant velocity model between two receivers. We first define the
model and the sources and receivers coordinates. We then calculate the travel
times for each receiver using the class
<a class="reference internal" href="../travel_times.html#covseisnet.travel_times.TravelTimes" title="covseisnet.travel_times.TravelTimes"><code class="xref py py-class docutils literal notranslate"><span class="pre">TravelTimes</span></code></a>, and we calculate the differential
travel times using the class
<a class="reference internal" href="../travel_times.html#covseisnet.travel_times.DifferentialTravelTimes" title="covseisnet.travel_times.DifferentialTravelTimes"><code class="xref py py-class docutils literal notranslate"><span class="pre">DifferentialTravelTimes</span></code></a>. Finally, we locate the
source of the seismic waves using the class
<a class="reference internal" href="../backprojection.html#covseisnet.backprojection.DifferentialBackProjection" title="covseisnet.backprojection.DifferentialBackProjection"><code class="xref py py-class docutils literal notranslate"><span class="pre">DifferentialBackProjection</span></code></a> and plot the
results on a map.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">cartopy.crs</span> <span class="kn">import</span> <span class="n">PlateCarree</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="kn">import</span> <span class="nn">covseisnet</span> <span class="k">as</span> <span class="nn">csn</span>
<span class="kn">from</span> <span class="nn">covseisnet.travel_times</span> <span class="kn">import</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class"><span class="n">TravelTimes</span></a><span class="p">,</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class"><span class="n">DifferentialTravelTimes</span></a>
<span class="kn">from</span> <span class="nn">covseisnet.backprojection</span> <span class="kn">import</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class"><span class="n">DifferentialBackProjection</span></a>
</pre></div>
</div>
<section id="load-seismograms">
<h2>Load seismograms<a class="headerlink" href="#load-seismograms" title="Link to this heading">#</a></h2>
<p>We first load the seismograms from the example data set. We downloaded the
seismogram from the Wilber 3 interface at
<a class="reference external" href="https://ds.iris.edu/wilber3/data_request/leonard-seydoux/2020-10-05-mb44-aegean-sea-1">https://ds.iris.edu/wilber3/data_request/leonard-seydoux/2020-10-05-mb44-aegean-sea-1</a>.
These seismograms contains the record of the Mb 4.4 earthquake that occurred
in the Aegean Sea on October 5, 2020 at 14:57:51 UTC at 39.9°N, 23.3° E and
10 km depth.</p>
<p>We also pre-process the seismograms by merging overlapping traces, removing
the linear trend, filtering the data with a high-pass filter with a corner
frequency of 0.01 Hz, and synchronizing the traces, as shown in the other
examples.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Load seismograms</span>
<span class="n">stream</span> <span class="o">=</span> <span class="n">csn</span><span class="o">.</span><span class="n">NetworkStream</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="s2">&quot;../data/aegean_sea_example.mseed&quot;</span><span class="p">)</span>

<span class="c1"># Pre-process</span>
<a href="https://docs.obspy.org/packages/autogen/obspy.core.stream.Stream.merge.html#obspy.core.stream.Stream.merge" title="obspy.core.stream.Stream.merge" class="sphx-glr-backref-module-obspy-core-stream sphx-glr-backref-type-py-method"><span class="n">stream</span><span class="o">.</span><span class="n">merge</span></a><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">fill_value</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<a href="https://docs.obspy.org/packages/autogen/obspy.core.stream.Stream.detrend.html#obspy.core.stream.Stream.detrend" title="obspy.core.stream.Stream.detrend" class="sphx-glr-backref-module-obspy-core-stream sphx-glr-backref-type-py-method"><span class="n">stream</span><span class="o">.</span><span class="n">detrend</span></a><span class="p">(</span><span class="s2">&quot;linear&quot;</span><span class="p">)</span>
<a href="https://docs.obspy.org/packages/autogen/obspy.core.stream.Stream.filter.html#obspy.core.stream.Stream.filter" title="obspy.core.stream.Stream.filter" class="sphx-glr-backref-module-obspy-core-stream sphx-glr-backref-type-py-method"><span class="n">stream</span><span class="o">.</span><span class="n">filter</span></a><span class="p">(</span><span class="s2">&quot;highpass&quot;</span><span class="p">,</span> <span class="n">freq</span><span class="o">=</span><span class="mf">0.01</span><span class="p">)</span>
<span class="n">stream</span><span class="o">.</span><span class="n">synchronize</span><span class="p">()</span>
</pre></div>
</div>
</section>
<section id="station-and-source-coordinates">
<h2>Station and source coordinates<a class="headerlink" href="#station-and-source-coordinates" title="Link to this heading">#</a></h2>
<p>We associate the coordinates of the different stations to the corresponding
seismograms. We first download the inventory of the seismograms from the
National Observatory of Athens (NOA) data center. We then associate the
coordinates to the seismograms using the method
<code class="xref py py-func docutils literal notranslate"><span class="pre">assign_coordinates()</span></code>. The
<code class="xref py py-class docutils literal notranslate"><span class="pre">obspy.Inventory</span></code> object is then used to plot the stations on a map.</p>
<p>We also add the known source coordinates of the earthquake to the map, to
compare the location of the earthquake with the location of the
backprojection results.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Get inventory to assign station coordinates</span>
<a href="https://docs.obspy.org/packages/autogen/obspy.core.inventory.inventory.Inventory.html#obspy.core.inventory.inventory.Inventory" title="obspy.core.inventory.inventory.Inventory" class="sphx-glr-backref-module-obspy-core-inventory-inventory sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">inventory</span></a> <span class="o">=</span> <span class="n">stream</span><span class="o">.</span><span class="n">download_inventory</span><span class="p">(</span><span class="n">datacenter</span><span class="o">=</span><span class="s2">&quot;NOA&quot;</span><span class="p">)</span>
<span class="n">stream</span><span class="o">.</span><span class="n">assign_coordinates</span><span class="p">(</span><a href="https://docs.obspy.org/packages/autogen/obspy.core.inventory.inventory.Inventory.html#obspy.core.inventory.inventory.Inventory" title="obspy.core.inventory.inventory.Inventory" class="sphx-glr-backref-module-obspy-core-inventory-inventory sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">inventory</span></a><span class="p">)</span>
<a href="https://matplotlib.org/stable/api/_as_gen/matplotlib.figure.Figure.html#matplotlib.figure.Figure" title="matplotlib.figure.Figure" class="sphx-glr-backref-module-matplotlib-figure sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">fig</span></a> <span class="o">=</span> <a href="https://docs.obspy.org/packages/autogen/obspy.core.inventory.inventory.Inventory.plot.html#obspy.core.inventory.inventory.Inventory.plot" title="obspy.core.inventory.inventory.Inventory.plot" class="sphx-glr-backref-module-obspy-core-inventory-inventory sphx-glr-backref-type-py-method"><span class="n">inventory</span><span class="o">.</span><span class="n">plot</span></a><span class="p">(</span><span class="n">projection</span><span class="o">=</span><span class="s2">&quot;local&quot;</span><span class="p">,</span> <span class="n">resolution</span><span class="o">=</span><span class="s2">&quot;h&quot;</span><span class="p">)</span>

<span class="c1"># Plot source coordinates</span>
<a href="https://docs.python.org/3/library/stdtypes.html#tuple" title="builtins.tuple" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">source_location</span></a> <span class="o">=</span> <span class="mf">23.3465</span><span class="p">,</span> <span class="mf">39.8812</span><span class="p">,</span> <span class="mi">10</span>
<a href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.plot.html#matplotlib.pyplot.plot" title="matplotlib.pyplot.plot" class="sphx-glr-backref-module-matplotlib-pyplot sphx-glr-backref-type-py-function"><span class="n">plt</span><span class="o">.</span><span class="n">plot</span></a><span class="p">(</span><span class="o">*</span><a href="https://docs.python.org/3/library/stdtypes.html#tuple" title="builtins.tuple" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">source_location</span></a><span class="p">[:</span><span class="mi">2</span><span class="p">],</span> <span class="s2">&quot;k*&quot;</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">transform</span><span class="o">=</span><span class="n">PlateCarree</span><span class="p">())</span>

<span class="c1"># Extract natural extent for later use</span>
<a href="https://docs.python.org/3/library/stdtypes.html#tuple" title="builtins.tuple" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">extent</span></a> <span class="o">=</span> <a href="https://matplotlib.org/stable/api/_as_gen/matplotlib.figure.Figure.axes.html#matplotlib.figure.Figure.axes" title="matplotlib.figure.Figure.axes" class="sphx-glr-backref-module-matplotlib-figure sphx-glr-backref-type-py-property"><span class="n">fig</span><span class="o">.</span><span class="n">axes</span></a><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">get_extent</span><span class="p">(</span><span class="n">crs</span><span class="o">=</span><span class="n">PlateCarree</span><span class="p">())</span>
</pre></div>
</div>
<img src="../_images/sphx_glr_plot_example_d3_constant_velocity_loc_001.png" srcset="../_images/sphx_glr_plot_example_d3_constant_velocity_loc_001.png, ../_images/sphx_glr_plot_example_d3_constant_velocity_loc_001_4_00x.png 4.00x" alt="plot example d3 constant velocity loc" class = "sphx-glr-single-img"/></section>
<section id="evaluate-covariance-matrix">
<h2>Evaluate covariance matrix<a class="headerlink" href="#evaluate-covariance-matrix" title="Link to this heading">#</a></h2>
<p>We calculate the covariance matrix of the seismograms using the method
<a class="reference internal" href="../covariance.html#covseisnet.covariance.calculate_covariance_matrix" title="covseisnet.covariance.calculate_covariance_matrix"><code class="xref py py-func docutils literal notranslate"><span class="pre">calculate_covariance_matrix()</span></code></a>. We use a window
duration of 200 s, which allow for the slowest possible seismic waves to
propagate between the stations (overestimating the travel time). We average
the covariance matrix over 5 windows, which results in a single time window.</p>
<p>In this specific case, the coherence is a function of the frequency only. We
observe the earthquake-related signal induces a strong wavefield coherence
(that is, a low spectral width) between 1 and 10 Hz in particular.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Compute covariance matrix</span>
<a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">times</span></a><span class="p">,</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">frequencies</span></a><span class="p">,</span> <span class="n">covariances</span> <span class="o">=</span> <span class="n">csn</span><span class="o">.</span><span class="n">covariance</span><span class="o">.</span><span class="n">calculate_covariance_matrix</span><span class="p">(</span>
    <span class="n">stream</span><span class="p">,</span> <span class="n">window_duration</span><span class="o">=</span><span class="mi">200</span><span class="p">,</span> <span class="n">average</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">whiten</span><span class="o">=</span><span class="s2">&quot;none&quot;</span>
<span class="p">)</span>

<span class="c1"># Calculate coherence</span>
<a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">coherence</span></a> <span class="o">=</span> <span class="n">covariances</span><span class="o">.</span><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">coherence</span></a><span class="p">(</span><span class="n">kind</span><span class="o">=</span><span class="s2">&quot;spectral_width&quot;</span><span class="p">)</span>

<span class="c1"># Show</span>
<a href="https://matplotlib.org/stable/api/_as_gen/matplotlib.figure.Figure.html#matplotlib.figure.Figure" title="matplotlib.figure.Figure" class="sphx-glr-backref-module-matplotlib-figure sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">fig</span></a><span class="p">,</span> <a href="https://docs.python.org/3/library/stdtypes.html#dict" title="builtins.dict" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">ax</span></a> <span class="o">=</span> <a href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.subplots.html#matplotlib.pyplot.subplots" title="matplotlib.pyplot.subplots" class="sphx-glr-backref-module-matplotlib-pyplot sphx-glr-backref-type-py-function"><span class="n">plt</span><span class="o">.</span><span class="n">subplots</span></a><span class="p">()</span>
<a href="https://docs.python.org/3/library/stdtypes.html#dict" title="builtins.dict" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">ax</span><span class="o">.</span><span class="n">semilogx</span></a><span class="p">(</span><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">frequencies</span></a><span class="p">,</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">coherence</span></a><span class="o">.</span><span class="n">squeeze</span><span class="p">())</span>
<a href="https://docs.python.org/3/library/stdtypes.html#dict" title="builtins.dict" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span></a><span class="p">(</span><span class="s2">&quot;Frequency (Hz)&quot;</span><span class="p">)</span>
<a href="https://docs.python.org/3/library/stdtypes.html#dict" title="builtins.dict" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span></a><span class="p">(</span><span class="s2">&quot;Covariance matrix spectral width&quot;</span><span class="p">)</span>
<a href="https://docs.python.org/3/library/stdtypes.html#dict" title="builtins.dict" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">ax</span><span class="o">.</span><span class="n">grid</span></a><span class="p">()</span>
</pre></div>
</div>
<img src="../_images/sphx_glr_plot_example_d3_constant_velocity_loc_002.png" srcset="../_images/sphx_glr_plot_example_d3_constant_velocity_loc_002.png, ../_images/sphx_glr_plot_example_d3_constant_velocity_loc_002_4_00x.png 4.00x" alt="plot example d3 constant velocity loc" class = "sphx-glr-single-img"/></section>
<section id="evaluate-the-pairwise-cross-correlation-functions">
<h2>Evaluate the pairwise cross-correlation functions<a class="headerlink" href="#evaluate-the-pairwise-cross-correlation-functions" title="Link to this heading">#</a></h2>
<p>We calculate the pairwise cross-correlation functions between the seismograms
using the method <a class="reference internal" href="../correlation.html#covseisnet.correlation.calculate_cross_correlation_matrix" title="covseisnet.correlation.calculate_cross_correlation_matrix"><code class="xref py py-func docutils literal notranslate"><span class="pre">calculate_cross_correlation_matrix()</span></code></a>.
We exclude the autocorrelation functions from the calculation, as they are not
useful for the backprojection.</p>
<p>We also pre-process the cross-correlation functions by tapering the edges of
the functions, bandpass filtering the data between 1 and 5 Hz, calculating the
envelope of the data, and smoothing the data with a Gaussian filter with a
standard deviation of 30 samples. Finally, we normalize the data by the maximum
value of each cross-correlation function.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Calculate cross-correlation functions</span>
<a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">lags</span></a><span class="p">,</span> <a href="https://docs.python.org/3/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">pairs</span></a><span class="p">,</span> <span class="n">correlations</span> <span class="o">=</span> <span class="n">csn</span><span class="o">.</span><span class="n">correlation</span><span class="o">.</span><span class="n">calculate_cross_correlation_matrix</span><span class="p">(</span>
    <span class="n">covariances</span><span class="p">,</span> <span class="n">include_autocorrelation</span><span class="o">=</span><span class="kc">False</span>
<span class="p">)</span>


<span class="c1"># Pre-process the cross-correlation functions</span>
<span class="n">correlations</span> <span class="o">=</span> <span class="n">correlations</span><span class="o">.</span><span class="n">taper</span><span class="p">(</span><span class="mf">0.1</span><span class="p">)</span>
<span class="n">correlations</span> <span class="o">=</span> <span class="n">correlations</span><span class="o">.</span><span class="n">bandpass</span><span class="p">(</span><span class="n">frequency_band</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<span class="n">correlations</span> <span class="o">=</span> <span class="n">correlations</span><span class="o">.</span><span class="n">envelope</span><span class="p">()</span>
<span class="n">correlations</span> <span class="o">=</span> <span class="n">correlations</span><span class="o">.</span><span class="n">smooth</span><span class="p">(</span><span class="n">sigma</span><span class="o">=</span><span class="mi">30</span><span class="p">)</span>
<span class="n">correlations</span> <span class="o">/=</span> <span class="n">correlations</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">axis</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span> <span class="n">keepdims</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">correlations</span> <span class="o">=</span> <span class="n">correlations</span><span class="o">.</span><span class="n">squeeze</span><span class="p">()</span>
</pre></div>
</div>
</section>
<section id="calculate-travel-times">
<h2>Calculate travel times<a class="headerlink" href="#calculate-travel-times" title="Link to this heading">#</a></h2>
<p>We calculate the travel times of the seismic waves between the stations using
the class <a class="reference internal" href="../travel_times.html#covseisnet.travel_times.TravelTimes" title="covseisnet.travel_times.TravelTimes"><code class="xref py py-class docutils literal notranslate"><span class="pre">TravelTimes</span></code></a>. We use a constant
velocity model with a velocity of 3.5 km/s, assuming that the S-waves will
dominate the seismic records. We then calculate the differential travel times
between the stations using the class
<a class="reference internal" href="../travel_times.html#covseisnet.travel_times.DifferentialTravelTimes" title="covseisnet.travel_times.DifferentialTravelTimes"><code class="xref py py-class docutils literal notranslate"><span class="pre">DifferentialTravelTimes</span></code></a>.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Define the velocity model</span>
<a href="https://docs.python.org/3/library/stdtypes.html#tuple" title="builtins.tuple" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">extent_with_depth</span></a> <span class="o">=</span> <a href="https://docs.python.org/3/library/stdtypes.html#tuple" title="builtins.tuple" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">extent</span></a> <span class="o">+</span> <span class="p">(</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="mi">20</span><span class="p">)</span>

<span class="n">model</span> <span class="o">=</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class"><span class="n">csn</span><span class="o">.</span><span class="n">velocity</span><span class="o">.</span><span class="n">ConstantVelocityModel</span></a><span class="p">(</span>
    <a href="https://docs.python.org/3/library/stdtypes.html#tuple" title="builtins.tuple" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">extent</span></a><span class="o">=</span><a href="https://docs.python.org/3/library/stdtypes.html#tuple" title="builtins.tuple" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">extent_with_depth</span></a><span class="p">,</span> <span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="mi">40</span><span class="p">,</span> <span class="mi">40</span><span class="p">,</span> <span class="mi">40</span><span class="p">),</span> <span class="n">velocity</span><span class="o">=</span><span class="mf">3.5</span>
<span class="p">)</span>

<span class="c1"># Obtain the travel times</span>
<a href="https://docs.python.org/3/library/stdtypes.html#dict" title="builtins.dict" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">travel_times</span></a> <span class="o">=</span> <span class="p">{</span>
    <span class="n">trace</span><span class="o">.</span><span class="n">stats</span><span class="o">.</span><span class="n">station</span><span class="p">:</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class"><span class="n">TravelTimes</span></a><span class="p">(</span><span class="n">stats</span><span class="o">=</span><span class="n">trace</span><span class="o">.</span><span class="n">stats</span><span class="p">,</span> <span class="n">velocity_model</span><span class="o">=</span><span class="n">model</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">trace</span> <span class="ow">in</span> <span class="n">stream</span>
<span class="p">}</span>

<span class="c1"># Calculate differential travel times</span>
<a href="https://docs.python.org/3/library/stdtypes.html#dict" title="builtins.dict" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">differential_travel_times</span></a> <span class="o">=</span> <span class="p">{}</span>
<span class="k">for</span> <a href="https://docs.python.org/3/library/stdtypes.html#tuple" title="builtins.tuple" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">pair</span></a> <span class="ow">in</span> <a href="https://docs.python.org/3/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">pairs</span></a><span class="p">:</span>
    <a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">station_1</span></a><span class="p">,</span> <a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">station_2</span></a> <span class="o">=</span> <a href="https://docs.python.org/3/library/stdtypes.html#tuple" title="builtins.tuple" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">pair</span></a>
    <a href="https://docs.python.org/3/library/stdtypes.html#dict" title="builtins.dict" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">differential_travel_times</span></a><span class="p">[</span><a href="https://docs.python.org/3/library/stdtypes.html#tuple" title="builtins.tuple" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">pair</span></a><span class="p">]</span> <span class="o">=</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class"><span class="n">DifferentialTravelTimes</span></a><span class="p">(</span>
        <a href="https://docs.python.org/3/library/stdtypes.html#dict" title="builtins.dict" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">travel_times</span></a><span class="p">[</span><a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">station_1</span></a><span class="p">],</span>
        <a href="https://docs.python.org/3/library/stdtypes.html#dict" title="builtins.dict" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">travel_times</span></a><span class="p">[</span><a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">station_2</span></a><span class="p">],</span>
    <span class="p">)</span>
</pre></div>
</div>
</section>
<section id="locate-the-source-with-backprojection">
<h2>Locate the source with backprojection<a class="headerlink" href="#locate-the-source-with-backprojection" title="Link to this heading">#</a></h2>
<p>We locate the source of the seismic waves using the class
<a class="reference internal" href="../backprojection.html#covseisnet.backprojection.DifferentialBackProjection" title="covseisnet.backprojection.DifferentialBackProjection"><code class="xref py py-class docutils literal notranslate"><span class="pre">DifferentialBackProjection</span></code></a>. We use the
differential travel times calculated previously and the pre-processed
cross-correlation functions. We calculate the likelihood of the source location
using the method <a class="reference internal" href="../backprojection.html#covseisnet.backprojection.DifferentialBackProjection.calculate_likelihood" title="covseisnet.backprojection.DifferentialBackProjection.calculate_likelihood"><code class="xref py py-func docutils literal notranslate"><span class="pre">calculate_likelihood()</span></code></a>.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Calculate likelihood</span>
<span class="n">backprojection</span> <span class="o">=</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class"><span class="n">DifferentialBackProjection</span></a><span class="p">(</span><a href="https://docs.python.org/3/library/stdtypes.html#dict" title="builtins.dict" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">differential_travel_times</span></a><span class="p">)</span>
<span class="n">backprojection</span><span class="o">.</span><span class="n">calculate_likelihood</span><span class="p">(</span><span class="n">cross_correlation</span><span class="o">=</span><span class="n">correlations</span><span class="p">)</span>

<span class="c1"># Plot likelihood in 3D</span>
<a href="https://docs.python.org/3/library/stdtypes.html#dict" title="builtins.dict" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">ax</span></a> <span class="o">=</span> <span class="n">csn</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">grid3d</span><span class="p">(</span><span class="n">backprojection</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s2">&quot;viridis&quot;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Likelihood&quot;</span><span class="p">)</span>
</pre></div>
</div>
<img src="../_images/sphx_glr_plot_example_d3_constant_velocity_loc_003.png" srcset="../_images/sphx_glr_plot_example_d3_constant_velocity_loc_003.png, ../_images/sphx_glr_plot_example_d3_constant_velocity_loc_003_4_00x.png 4.00x" alt="plot example d3 constant velocity loc" class = "sphx-glr-single-img"/></section>
<section id="compare-maximum-likelihood-with-known-source-location">
<h2>Compare maximum likelihood with known source location<a class="headerlink" href="#compare-maximum-likelihood-with-known-source-location" title="Link to this heading">#</a></h2>
<p>The maximum likelihood of the source location is calculated using the method
<a class="reference internal" href="../backprojection.html#covseisnet.backprojection.DifferentialBackProjection.maximum_coordinates" title="covseisnet.backprojection.DifferentialBackProjection.maximum_coordinates"><code class="xref py py-func docutils literal notranslate"><span class="pre">maximum_coordinates()</span></code></a>.
We plot the source location and the maximum likelihood of the source location
on the map.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Infer maximum coordinates</span>
<a href="https://docs.python.org/3/library/stdtypes.html#tuple" title="builtins.tuple" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">max_likelihood</span></a> <span class="o">=</span> <span class="n">backprojection</span><span class="o">.</span><span class="n">maximum_coordinates</span><span class="p">()</span>

<span class="c1"># Plot source and estimated location</span>
<a href="https://matplotlib.org/stable/api/_as_gen/matplotlib.figure.Figure.html#matplotlib.figure.Figure" title="matplotlib.figure.Figure" class="sphx-glr-backref-module-matplotlib-figure sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">fig</span></a> <span class="o">=</span> <a href="https://docs.obspy.org/packages/autogen/obspy.core.inventory.inventory.Inventory.plot.html#obspy.core.inventory.inventory.Inventory.plot" title="obspy.core.inventory.inventory.Inventory.plot" class="sphx-glr-backref-module-obspy-core-inventory-inventory sphx-glr-backref-type-py-method"><span class="n">inventory</span><span class="o">.</span><span class="n">plot</span></a><span class="p">(</span><span class="n">projection</span><span class="o">=</span><span class="s2">&quot;local&quot;</span><span class="p">,</span> <span class="n">resolution</span><span class="o">=</span><span class="s2">&quot;h&quot;</span><span class="p">)</span>
<a href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.plot.html#matplotlib.pyplot.plot" title="matplotlib.pyplot.plot" class="sphx-glr-backref-module-matplotlib-pyplot sphx-glr-backref-type-py-function"><span class="n">plt</span><span class="o">.</span><span class="n">plot</span></a><span class="p">(</span><span class="o">*</span><a href="https://docs.python.org/3/library/stdtypes.html#tuple" title="builtins.tuple" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">source_location</span></a><span class="p">[:</span><span class="mi">2</span><span class="p">],</span> <span class="s2">&quot;k*&quot;</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">transform</span><span class="o">=</span><span class="n">PlateCarree</span><span class="p">())</span>
<a href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.plot.html#matplotlib.pyplot.plot" title="matplotlib.pyplot.plot" class="sphx-glr-backref-module-matplotlib-pyplot sphx-glr-backref-type-py-function"><span class="n">plt</span><span class="o">.</span><span class="n">plot</span></a><span class="p">(</span><span class="o">*</span><a href="https://docs.python.org/3/library/stdtypes.html#tuple" title="builtins.tuple" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">max_likelihood</span></a><span class="p">[:</span><span class="mi">2</span><span class="p">],</span> <span class="s2">&quot;r*&quot;</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">transform</span><span class="o">=</span><span class="n">PlateCarree</span><span class="p">())</span>
</pre></div>
</div>
<img src="../_images/sphx_glr_plot_example_d3_constant_velocity_loc_004.png" srcset="../_images/sphx_glr_plot_example_d3_constant_velocity_loc_004.png, ../_images/sphx_glr_plot_example_d3_constant_velocity_loc_004_4_00x.png 4.00x" alt="plot example d3 constant velocity loc" class = "sphx-glr-single-img"/><p class="sphx-glr-timing"><strong>Total running time of the script:</strong> (0 minutes 41.716 seconds)</p>
<div class="sphx-glr-footer sphx-glr-footer-example docutils container" id="sphx-glr-download-auto-examples-plot-example-d3-constant-velocity-loc-py">
<div class="sphx-glr-download sphx-glr-download-jupyter docutils container">
<p><a class="reference download internal" download="" href="../_downloads/995c70152644b6b3f4c84f47d6ef7f0d/plot_example_d3_constant_velocity_loc.ipynb"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">Jupyter</span> <span class="pre">notebook:</span> <span class="pre">plot_example_d3_constant_velocity_loc.ipynb</span></code></a></p>
</div>
<div class="sphx-glr-download sphx-glr-download-python docutils container">
<p><a class="reference download internal" download="" href="../_downloads/6ff55a2a7ddc7d720bb57a5e9b5e9003/plot_example_d3_constant_velocity_loc.py"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">Python</span> <span class="pre">source</span> <span class="pre">code:</span> <span class="pre">plot_example_d3_constant_velocity_loc.py</span></code></a></p>
</div>
<div class="sphx-glr-download sphx-glr-download-zip docutils container">
<p><a class="reference download internal" download="" href="../_downloads/562422111f86ec530bf788c501a1bd86/plot_example_d3_constant_velocity_loc.zip"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">zipped:</span> <span class="pre">plot_example_d3_constant_velocity_loc.zip</span></code></a></p>
</div>
</div>
<p class="sphx-glr-signature"><a class="reference external" href="https://sphinx-gallery.github.io">Gallery generated by Sphinx-Gallery</a></p>
</section>
</section>


                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="plot_example_d2_constant_velocity_diff.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Constant velocity differential times</p>
      </div>
    </a>
    <a class="right-next"
       href="../api.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">API Reference</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#load-seismograms">Load seismograms</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#station-and-source-coordinates">Station and source coordinates</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#evaluate-covariance-matrix">Evaluate covariance matrix</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#evaluate-the-pairwise-cross-correlation-functions">Evaluate the pairwise cross-correlation functions</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#calculate-travel-times">Calculate travel times</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#locate-the-source-with-backprojection">Locate the source with backprojection</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#compare-maximum-likelihood-with-known-source-location">Compare maximum likelihood with known source location</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Léonard Seydoux, Jean Soubestre, Cyril Journeau, Francis Tong & Nikolai Shapiro
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2022, The Covseisnet Team.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>