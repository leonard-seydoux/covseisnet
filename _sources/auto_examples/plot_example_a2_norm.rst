
.. DO NOT EDIT.
.. THIS FILE WAS AUTOMATICALLY GENERATED BY SPHINX-GALLERY.
.. TO MAKE CHANGES, EDIT THE SOURCE PYTHON FILE:
.. "auto_examples/plot_example_a2_norm.py"
.. LINE NUMBERS ARE GIVEN BELOW.

.. only:: html

    .. note::
        :class: sphx-glr-download-link-note

        :ref:`Go to the end <sphx_glr_download_auto_examples_plot_example_a2_norm.py>`
        to download the full example code.

.. rst-class:: sphx-glr-example-title

.. _sphx_glr_auto_examples_plot_example_a2_norm.py:


Temporal normalization
======================

This example shows how to perform a temporal normalization of traces with
different methods. 

.. GENERATED FROM PYTHON SOURCE LINES 8-13

.. code-block:: Python


    import matplotlib.pyplot as plt

    import covseisnet as csn








.. GENERATED FROM PYTHON SOURCE LINES 14-19

Read waveforms
--------------

This section reads an example stream of seismic data, which is shipped with
ObsPy. The stream contains three traces.

.. GENERATED FROM PYTHON SOURCE LINES 19-29

.. code-block:: Python


    # Read the example stream (shipped with ObsPy)
    stream = csn.read()

    # Highpass filter the stream to better see the sync in high frequencies
    stream.filter("highpass", freq=1.0)

    # Print the original stream
    print(stream)





.. rst-class:: sphx-glr-script-out

 .. code-block:: none

    3 Trace(s) in NetworkStream (synced):
    BW.RJOB..EHZ | 2009-08-24T00:20:03.000000Z - 2009-08-24T00:20:32.990000Z | 100.0 Hz, 3000 samples
    BW.RJOB..EHN | 2009-08-24T00:20:03.000000Z - 2009-08-24T00:20:32.990000Z | 100.0 Hz, 3000 samples
    BW.RJOB..EHE | 2009-08-24T00:20:03.000000Z - 2009-08-24T00:20:32.990000Z | 100.0 Hz, 3000 samples




.. GENERATED FROM PYTHON SOURCE LINES 30-35

----------------------

We here show the trace normalized with different methods. The methods are
applied to the stream, and the normalized traces are stored in a list. See\
:footcite:`bensen2007processing` for more information on the normalization

.. GENERATED FROM PYTHON SOURCE LINES 35-46

.. code-block:: Python


    # Initialize the list of normalized streams
    normalization_methods = ["onebit", "smooth"]
    normalized_streams = []

    # Normalize the stream with the different methods
    for method in normalization_methods:
        normalized_stream = stream.copy()
        normalized_stream.time_normalize(method=method)
        normalized_streams.append(normalized_stream)








.. GENERATED FROM PYTHON SOURCE LINES 47-53

Comparison
----------

This section compares the original stream with the normalized streams. The
traces are plotted in a figure, where the original stream is plotted first,
and the normalized streams are plotted below.

.. GENERATED FROM PYTHON SOURCE LINES 53-72

.. code-block:: Python


    # Concatenate the original stream with the normalized streams
    streams = [stream] + normalized_streams
    labels = ["original"] + normalization_methods

    # Create gigure
    fig, axes = plt.subplots(len(streams), sharex=True, constrained_layout=True)

    # Plot each case
    for ax, stream, label in zip(axes, streams, labels):
        ax.plot(stream.times("matplotlib"), stream.traces[0].data)
        ax.set_title(label.title())
        ax.set_ylabel("Amplitude")
        ax.grid()

    # Set the x-axis label
    csn.plot.dateticks(axes[-1])





.. image-sg:: /auto_examples/images/sphx_glr_plot_example_a2_norm_001.png
   :alt: Original, Onebit, Smooth
   :srcset: /auto_examples/images/sphx_glr_plot_example_a2_norm_001.png, /auto_examples/images/sphx_glr_plot_example_a2_norm_001_4_00x.png 4.00x
   :class: sphx-glr-single-img





.. GENERATED FROM PYTHON SOURCE LINES 73-77

References
----------

.. footbibliography::


.. rst-class:: sphx-glr-timing

   **Total running time of the script:** (0 minutes 1.121 seconds)


.. _sphx_glr_download_auto_examples_plot_example_a2_norm.py:

.. only:: html

  .. container:: sphx-glr-footer sphx-glr-footer-example

    .. container:: sphx-glr-download sphx-glr-download-jupyter

      :download:`Download Jupyter notebook: plot_example_a2_norm.ipynb <plot_example_a2_norm.ipynb>`

    .. container:: sphx-glr-download sphx-glr-download-python

      :download:`Download Python source code: plot_example_a2_norm.py <plot_example_a2_norm.py>`

    .. container:: sphx-glr-download sphx-glr-download-zip

      :download:`Download zipped: plot_example_a2_norm.zip <plot_example_a2_norm.zip>`


.. only:: html

 .. rst-class:: sphx-glr-signature

    `Gallery generated by Sphinx-Gallery <https://sphinx-gallery.github.io>`_
